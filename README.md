# yaforms
Небольшая программка для скачивания результатов форм Яндекса и отправки их ботом telegram

# Описание
Запускается файл main.py
После запуска скрипта, он будет работать постоянно и в заранее заданные часы и даты будет открывать браузер, переходить по заранее заданной ссылке, сскачивать результаты работы Яндекс.Формы, редактировать, так, чтоб первый столбец заполнялся заданным регионом, второй столбец заполнялся номерами телефонов, третий заполнялся единицами.

По итогу будет три столбца в csv файле: "region", "mob_phone", "voice"

# Требования
Необходимо, чтоб браузер Chrom был закрыт, иначе скрипт не сработает.
Перед работой необходимо внести некоторые изменения, они указаны ниже.
Дополнительно необходимо начать диалог с Вашим ботом, чтоб файлы были отправлены.

# Инструкция
1. Установить python
2. Скачать репозиторий
3. Открыть его в командной строке
4. Установить виртуальное окружение:
```bash
python -m venv .venv
```
5. Активаировать виртуальное окружение:
```bash
.\.venv\Scripts\Activate.ps1
```
6. Установить все зависимости:
```bash
pip install -r requirements.txt
```
7. Запустить бота:
```bash
python .\bot.py
```
8. В отдельной командной строке, запустив виртуальное окружение при помощи команды из пункта 5 запустить сам скрипт:
```bash
python.exe .\main.py
```
# Персональные изменения для каждого региона
Для полноценной работы необходимо:
1. В main.py:
    - Указать путь к драйверу браузера Chrome (предварительно [скачав](https://storage.googleapis.com/chrome-for-testing-public/122.0.6261.128/win64/chromedriver-win64.zip) его)
    - Указать путь к папке с профилем Chrome
    - Указать URL страницы Яндекс Формы, выставив ответов самой формы все необходимые параметры (таблица, какие ответы нужны). Скопировать получившийся адрнес страницы из URL браузера
    - Указать папку, куда по умолчанию сохраняются все скачанные файлы.
    - Указать даты и время работы скрипта по скачиванию и редактированию результатов Яндекс Формы

2. В excel_reform.py:
    - В строке 25 поменять название файла для поиска
    - В строке 45 поменять название файла как он должен будет называться

3. В bot.py:
    - Указать токен бота
    - Указать id пользователя, кому будет отправляться файл
    - В строке 31 указать часть имени файла, который будет отправляться ботом пользователю 